<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MuDoc - Güvenli Depolama Alanınız</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        /* CSS for the glow/illumination effect */
        .neon-glow {
            text-shadow: 0 0 5px #f97316, 0 0 10px #f97316, 0 0 20px #ea580c;
        }
        .card-glow {
            box-shadow: 0 0 10px rgba(249, 115, 22, 0.4), 0 0 20px rgba(249, 115, 22, 0.2);
        }
        .btn-glow {
            transition: all 0.2s ease-in-out;
            box-shadow: 0 0 8px rgba(249, 115, 22, 0.6);
        }
        .btn-glow:hover {
            box-shadow: 0 0 15px rgba(249, 115, 22, 0.9), 0 0 30px rgba(249, 115, 22, 0.5);
            transform: translateY(-1px);
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d0d0d; /* Slightly darker black background */
        }
        /* Scrollbar styling for a dark theme */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1f2937; /* Dark gray for track */
        }
        ::-webkit-scrollbar-thumb {
            background: #f97316; /* Orange for thumb */
            border-radius: 4px;
        }
        .container-item.active {
            background-color: #f97316; /* Orange-600 */
            color: #1f2937; /* Dark text */
            font-weight: 600;
        }
        .container-item.active .text-gray-400 {
            color: #1f2937 !important;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen p-4 sm:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-6xl font-extrabold text-orange-400 neon-glow">MuDoc V2</h1>
            <p class="mt-2 text-xl text-gray-400">Özel Konumlarınız, Şifre Korumalı Dosya ve Notlarınız.</p>
        </header>

        <!-- Main Content Grid: Containers List (Left) and Content Area (Right) -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">

            <!-- 1. Konumlar Listesi (Containers) -->
            <div class="lg:col-span-1 p-6 bg-gray-800 rounded-xl card-glow h-fit">
                <h2 class="text-3xl font-bold mb-4 text-orange-400">Konumlar</h2>

                <!-- Add New Container Form -->
                <div class="space-y-3 mb-6 p-3 bg-gray-900 rounded-lg border border-orange-500/30">
                    <input type="text" id="new-container-name" placeholder="Yeni Konum Adı (örn: Ofis)"
                           class="w-full p-2 bg-gray-700 border border-gray-600 text-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500/50 placeholder-gray-500 text-sm">
                    <input type="password" id="new-container-password" placeholder="Şifre (Zorunlu Değil)"
                           class="w-full p-2 bg-gray-700 border border-gray-600 text-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500/50 placeholder-gray-500 text-sm">
                    <button onclick="createContainer()"
                            class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 rounded-lg btn-glow text-sm">
                        Konum Oluştur
                    </button>
                </div>

                <!-- Containers List -->
                <div id="containers-list" class="space-y-2 max-h-96 overflow-y-auto">
                    <!-- Container items will be injected here -->
                    <p class="text-center py-4 text-gray-500 text-sm" id="no-containers-message">
                        Henüz hiç konum oluşturulmadı.
                    </p>
                </div>
            </div>

            <!-- 2. Konum İçeriği (Container Content) -->
            <div class="lg:col-span-3 p-6 bg-gray-800 rounded-xl card-glow min-h-[600px]">
                <div id="content-area">
                    <h2 class="text-3xl font-bold mb-4 text-orange-400">İçerik Görüntüleyici</h2>
                    <div id="welcome-message" class="text-center py-20 text-gray-500 text-lg">
                        Lütfen soldan bir konum seçin veya yeni bir konum oluşturun.
                    </div>
                    <!-- Dynamic content will be loaded here -->
                </div>
            </div>

        </div>
    </div>

    <!-- Message Box/Modal -->
    <div id="message-box" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center p-4 z-50">
        <div class="bg-gray-800 p-6 rounded-xl card-glow max-w-sm w-full border border-orange-500">
            <h3 class="text-xl font-bold text-orange-400 mb-4" id="message-title">Bilgi</h3>
            <p class="text-gray-300 mb-6" id="message-content">Mesaj içeriği.</p>
            <button onclick="closeMessageBox()"
                    class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 rounded-lg btn-glow">
                Kapat
            </button>
        </div>
    </div>

    <!-- Modals for Password and Rename -->
    <div id="password-modal" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center p-4 z-50">
        <div class="bg-gray-800 p-6 rounded-xl card-glow max-w-sm w-full border border-orange-500">
            <h3 class="text-xl font-bold text-orange-400 mb-4">Konum Kilitli</h3>
            <p class="text-gray-300 mb-4" id="password-modal-name"></p>
            <input type="password" id="password-modal-input" placeholder="Şifreyi Girin"
                   class="w-full p-3 bg-gray-700 border border-gray-600 text-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500/50 placeholder-gray-500 mb-4">
            <button onclick="unlockContainerAttempt()"
                    class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 rounded-lg btn-glow">
                Kilidi Aç
            </button>
            <button onclick="closePasswordModal()"
                    class="w-full mt-2 bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 rounded-lg">
                İptal
            </button>
        </div>
    </div>

    <div id="rename-modal" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center p-4 z-50">
        <div class="bg-gray-800 p-6 rounded-xl card-glow max-w-sm w-full border border-orange-500">
            <h3 class="text-xl font-bold text-orange-400 mb-4">Konumu Yeniden Adlandır</h3>
            <input type="text" id="rename-modal-input" placeholder="Yeni Ad"
                   class="w-full p-3 bg-gray-700 border border-gray-600 text-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500/50 placeholder-gray-500 mb-4">
            <button onclick="commitRename()"
                    class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 rounded-lg btn-glow">
                Kaydet
            </button>
            <button onclick="closeRenameModal()"
                    class="w-full mt-2 bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 rounded-lg">
                İptal
            </button>
        </div>
    </div>

    <script>
        // Global storage key
        const CONTAINERS_KEY = 'muDocContainers';
        let containers = [];
        let activeContainerId = null;
        let containerToRenameId = null; // Used by the rename modal

        // --- Utility Functions ---

        /** Shows the custom message box */
        function showMessageBox(title, content) {
            document.getElementById('message-title').textContent = title;
            document.getElementById('message-content').textContent = content;
            document.getElementById('message-box').classList.remove('hidden');
            document.getElementById('message-box').classList.add('flex');
        }

        /** Hides the custom message box */
        function closeMessageBox() {
            document.getElementById('message-box').classList.add('hidden');
            document.getElementById('message-box').classList.remove('flex');
        }

        /** Generates a unique ID */
        function generateId() {
            if (typeof crypto !== 'undefined' && crypto.randomUUID) {
                return crypto.randomUUID();
            }
            return Date.now().toString(36) + Math.random().toString(36).substring(2);
        }

        // --- Container Data Handling ---

        function loadContainers() {
            try {
                const savedContainers = localStorage.getItem(CONTAINERS_KEY);
                containers = savedContainers ? JSON.parse(savedContainers) : [];
                renderContainersList();

                // If a container was active, try to re-select it (it will be locked/unlocked as necessary)
                if (activeContainerId) {
                    selectContainer(activeContainerId);
                }
            } catch (e) {
                console.error("Konumlar yüklenirken hata oluştu:", e);
            }
        }

        function saveContainers() {
            try {
                localStorage.setItem(CONTAINERS_KEY, JSON.stringify(containers));
            } catch (e) {
                console.error("Konumlar kaydedilirken hata oluştu:", e);
                showMessageBox("Hata", "Konum verileriniz kaydedilemedi.");
            }
        }

        function getContainerById(id) {
            return containers.find(c => c.id === id);
        }

        // --- Container UI and Actions ---

        function renderContainersList() {
            const listContainer = document.getElementById('containers-list');
            listContainer.innerHTML = ''; // Önce tüm içeriği temizle

            if (containers.length === 0) {
                // Konteyner yoksa, "boş mesajı" HTML olarak yeniden ekle
                listContainer.innerHTML = `
                    <p class="text-center py-4 text-gray-500 text-sm" id="no-containers-message">
                        Henüz hiç konum oluşturulmadı.
                    </p>
                `;
                return;
            }

            containers.forEach(container => {
                const isActive = container.id === activeContainerId;
                const isLocked = container.password && !container.unlocked;

                const itemDiv = document.createElement('div');
                itemDiv.id = container-${container.id};
                itemDiv.className = container-item p-3 rounded-lg cursor-pointer flex justify-between items-center ${isActive ? 'active' : 'bg-gray-900 hover:bg-gray-700/50'};
                itemDiv.onclick = () => selectContainer(container.id);
                itemDiv.innerHTML = `
                    <span class="flex items-center truncate">
                        ${isLocked ? '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-red-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2h2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2h2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd" /></svg>' : '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-orange-400" viewBox="0 0 20 20" fill="currentColor"><path d="M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" /></svg>'}
                        <span class="truncate">${container.name}</span>
                    </span>
                    <span class="text-xs text-gray-400 ml-2">${container.content.length} öğe</span>
                `;

                listContainer.appendChild(itemDiv);
            });
        }

        function createContainer() {
            const nameInput = document.getElementById('new-container-name');
            const passwordInput = document.getElementById('new-container-password');
            const name = nameInput.value.trim();
            const password = passwordInput.value.trim();

            if (!name) {
                showMessageBox("Uyarı", "Lütfen bir konum adı girin.");
                return;
            }

            const newContainer = {
                id: generateId(),
                name: name,
                password: password, // Simple string password
                unlocked: !password, // Automatically unlocked if no password set
                content: []
            };

            containers.push(newContainer);
            saveContainers();
            nameInput.value = '';
            passwordInput.value = '';
            renderContainersList();
            selectContainer(newContainer.id); // Select and show the new container
        }

        function selectContainer(id) {
            activeContainerId = id;
            const container = getContainerById(id);
            if (!container) return;

            // Update UI list to reflect active item
            renderContainersList();

            if (container.password && !container.unlocked) {
                showPasswordModal(container.name);
            } else {
                renderContainerContent(container);
            }
        }

        // --- Password Logic ---

        function showPasswordModal(containerName) {
            document.getElementById('password-modal-name').textContent = Konumu açmak için şifreyi girin: ${containerName};
            document.getElementById('password-modal-input').value = '';
            document.getElementById('password-modal').classList.remove('hidden');
            document.getElementById('password-modal').classList.add('flex');
            document.getElementById('welcome-message').style.display = 'none'; // Hide welcome message
            document.getElementById('content-area').innerHTML = ''; // Clear main content
        }

        function closePasswordModal() {
            document.getElementById('password-modal').classList.add('hidden');
            document.getElementById('password-modal').classList.remove('flex');
            activeContainerId = null; // Deselect on cancel
            renderContainersList();
            document.getElementById('content-area').innerHTML = document.getElementById('welcome-message').outerHTML; // Show welcome message again
        }

        function unlockContainerAttempt() {
            const passwordInput = document.getElementById('password-modal-input').value;
            const container = getContainerById(activeContainerId);

            if (!container) {
                closePasswordModal();
                return;
            }

            if (container.password === passwordInput) {
                container.unlocked = true;
                saveContainers();
                closePasswordModal();
                renderContainerContent(container);
                renderContainersList(); // Update lock icon
            } else {
                showMessageBox("Hata", "Yanlış şifre! Lütfen tekrar deneyin.");
                document.getElementById('password-modal-input').value = '';
            }
        }

        // --- Rename Logic ---

        function openRenameModal(id) {
            const container = getContainerById(id);
            if (!container) return;

            containerToRenameId = id;
            document.getElementById('rename-modal-input').value = container.name;
            document.getElementById('rename-modal').classList.remove('hidden');
            document.getElementById('rename-modal').classList.add('flex');
        }

        function closeRenameModal() {
            document.getElementById('rename-modal').classList.add('hidden');
            document.getElementById('rename-modal').classList.remove('flex');
            containerToRenameId = null;
        }

        function commitRename() {
            const newName = document.getElementById('rename-modal-input').value.trim();
            const container = getContainerById(containerToRenameId);

            if (!newName) {
                showMessageBox("Uyarı", "Lütfen geçerli bir ad girin.");
                return;
            }

            if (container) {
                container.name = newName;
                saveContainers();
                renderContainersList();
                renderContainerContent(container); // Re-render content header
                closeRenameModal();
            }
        }

        // --- Content Management (Render, Add, Delete) ---

        function renderContainerContent(container) {
            const contentArea = document.getElementById('content-area');

            // Header and Action Buttons
            const headerHtml = `
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center border-b pb-4 mb-6 border-orange-500/50">
                    <h2 class="text-4xl font-extrabold text-orange-400 neon-glow mb-2 sm:mb-0 truncate">${container.name}</h2>
                    <div class="flex space-x-3">
                        <button onclick="openRenameModal('${container.id}')"
                                class="bg-gray-700 hover:bg-gray-600 text-gray-200 py-1 px-3 rounded-md text-sm btn-glow">
                            Ad Değiştir
                        </button>
                        <button onclick="lockContainer('${container.id}')" ${container.password ? '' : 'disabled title="Şifre yok"'}
                                class="bg-blue-700/50 hover:bg-blue-600/70 text-white py-1 px-3 rounded-md text-sm btn-glow disabled:opacity-50 disabled:cursor-not-allowed">
                            Kilitle
                        </button>
                        <button onclick="deleteContainer('${container.id}')"
                                class="bg-red-700/50 hover:bg-red-600/70 text-white py-1 px-3 rounded-md text-sm btn-glow">
                            Konumu Sil
                        </button>
                    </div>
                </div>

                <!-- Add Note/File Forms -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <!-- Add Note -->
                    <div class="p-4 bg-gray-900 rounded-lg border border-orange-500/30">
                        <h3 class="text-xl font-bold text-gray-200 mb-3">Yeni Not Ekle</h3>
                        <input type="text" id="note-title" placeholder="Not Başlığı" class="w-full p-2 bg-gray-700 border border-gray-600 text-gray-200 rounded-lg mb-2 text-sm">
                        <textarea id="note-content" rows="4" placeholder="Not içeriği..." class="w-full p-2 bg-gray-700 border border-gray-600 text-gray-200 rounded-lg resize-none mb-2 text-sm"></textarea>
                        <button onclick="addNoteToContainer('${container.id}')" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 rounded-lg btn-glow text-sm">
                            Notu Kaydet
                        </button>
                    </div>

                    <!-- Add File/Image -->
                    <div class="p-4 bg-gray-900 rounded-lg border border-orange-500/30">
                        <h3 class="text-xl font-bold text-gray-200 mb-3">Dosya/Fotoğraf Yükle (Max 5MB)</h3>
                        <p class="text-xs text-red-400 mb-3">UYARI: Büyük dosyalar tarayıcınızı yavaşlatabilir veya çökebilir (localStorage limiti!).</p>
                        <input type="file" id="file-input-${container.id}" 
                               class="w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-orange-50 file:text-orange-700 hover:file:bg-orange-100">
                        <input type="text" id="file-title-${container.id}" placeholder="Dosya Başlığı" class="w-full p-2 bg-gray-700 border border-gray-600 text-gray-200 rounded-lg my-2 text-sm">
                        <button onclick="handleFileUpload('${container.id}')" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 rounded-lg btn-glow text-sm mt-2">
                            Yükle ve Kaydet
                        </button>
                    </div>
                </div>

                <h3 class="text-2xl font-bold text-gray-300 mb-4">İçerikler (${container.content.length})</h3>
                <div id="container-content-list" class="space-y-4 min-h-[200px]">
                    <!-- Items list will be injected here -->
                </div>
            `;
            
            contentArea.innerHTML = headerHtml;
            renderContentItems(container);
        }

        function lockContainer(id) {
            const container = getContainerById(id);
            if (container && container.password) {
                container.unlocked = false;
                saveContainers();
                activeContainerId = null; // Deselect
                renderContainersList();
                document.getElementById('content-area').innerHTML = document.getElementById('welcome-message').outerHTML;
            } else if (container && !container.password) {
                showMessageBox("Uyarı", "Bu konumda şifre ayarlanmamış. Kilitlemek için önce şifre ayarlayın.");
            }
        }

        function deleteContainer(id) {
            if (confirm("Bu konumu ve içindeki TÜM içeriği kalıcı olarak silmek istediğinizden emin misiniz?")) {
                containers = containers.filter(c => c.id !== id);
                saveContainers();
                activeContainerId = null;
                renderContainersList();
                document.getElementById('content-area').innerHTML = document.getElementById('welcome-message').outerHTML;
                showMessageBox("Başarılı", "Konum başarıyla silindi.");
            }
        }

        function renderContentItems(container) {
            const list = document.getElementById('container-content-list');
            list.innerHTML = '';

            if (container.content.length === 0) {
                list.innerHTML = <p class="text-center py-10 text-gray-500">Bu konumda henüz hiç dosya veya not yok.</p>;
                return;
            }

            container.content.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach(item => {
                const itemDiv = document.createElement('div');
                let contentHtml = '';
                let icon = '';
                let bgColor = 'bg-gray-900';
                
                // Determine icon and content based on type
                if (item.type === 'note') {
                    icon = <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-orange-400 mr-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 8a6 6 0 01-7.743 5.743L10 14l-4.243 4.243a1 1 0 01-1.414 0l-1.414-1.414a1 1 0 010-1.414L8 10l-.257-1.257A6 6 0 1118 8zm-6-4a1 1 0 100 2 1 1 0 000-2z" clip-rule="evenodd" /></svg>;
                    contentHtml = <p class="text-sm text-gray-400 mt-1 whitespace-pre-wrap">${item.data.substring(0, 150)}${item.data.length > 150 ? '...' : ''}</p>;
                    bgColor = 'bg-gray-900/70';
                } else if (item.type === 'image') {
                    icon = <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-400 mr-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd" /></svg>;
                    contentHtml = <img src="${item.data}" alt="${item.title}" class="max-h-24 w-auto rounded-md mt-2 border border-gray-600"/>;
                    bgColor = 'bg-gray-900/50';
                } else if (item.type === 'file') {
                    icon = <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400 mr-3" viewBox="0 0 20 20" fill="currentColor"><path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7z" /><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>;
                    contentHtml = <a href="${item.data}" download="${item.title}" class="text-blue-400 hover:text-blue-300 text-sm underline mt-1 block">Dosyayı İndir (${item.mimeType.split('/')[1] || 'Bilinmiyor'})</a>;
                    bgColor = 'bg-gray-900/70';
                }

                itemDiv.className = p-4 ${bgColor} rounded-lg border border-gray-700 flex justify-between items-start transition duration-150 hover:border-orange-500/50;
                itemDiv.innerHTML = `
                    <div class="flex-grow min-w-0">
                        <div class="flex items-center">
                            ${icon}
                            <div class="min-w-0">
                                <p class="font-semibold text-lg text-gray-100 truncate">${item.title}</p>
                                <p class="text-xs text-gray-500">${item.date}</p>
                            </div>
                        </div>
                        ${contentHtml}
                    </div>
                    <button onclick="deleteContentItem('${container.id}', '${item.id}')"
                            class="flex-shrink-0 ml-4 bg-red-700/50 hover:bg-red-600/70 text-white p-1 rounded-full btn-glow self-start">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 10-2 0v6a1 1 0 102 0V8z" clip-rule="evenodd" /></svg>
                    </button>
                `;
                list.appendChild(itemDiv);
            });
        }

        // --- Add/Delete Content ---

        function addNoteToContainer(containerId) {
            const container = getContainerById(containerId);
            const titleInput = document.getElementById('note-title');
            const contentInput = document.getElementById('note-content');
            const title = titleInput.value.trim();
            const content = contentInput.value.trim();

            if (!title || !content) {
                showMessageBox("Uyarı", "Not başlığı ve içeriği boş olamaz.");
                return;
            }

            const newItem = {
                id: generateId(),
                type: 'note',
                title: title,
                data: content,
                date: new Date().toLocaleString('tr-TR')
            };

            container.content.unshift(newItem); // Add to the beginning
            saveContainers();
            renderContainerContent(container);
            renderContainersList(); // Update item count
            titleInput.value = '';
            contentInput.value = '';
            showMessageBox("Başarılı", "Notunuz konuma eklendi.");
        }

        function handleFileUpload(containerId) {
            const container = getContainerById(containerId);
            const fileInput = document.getElementById(file-input-${containerId});
            const titleInput = document.getElementById(file-title-${containerId});
            const file = fileInput.files[0];
            const title = titleInput.value.trim() || file?.name || 'Yüklenen Dosya';

            if (!file) {
                showMessageBox("Uyarı", "Lütfen bir dosya seçin.");
                return;
            }

            // Simple size check (e.g., max 5MB)
            const MAX_SIZE_MB = 5;
            if (file.size > MAX_SIZE_MB * 1024 * 1024) {
                 showMessageBox("Hata", Dosya boyutu ${MAX_SIZE_MB}MB'ı geçemez. Lütfen daha küçük bir dosya kullanın.);
                return;
            }

            const reader = new FileReader();

            reader.onload = function(event) {
                const base64Data = event.target.result;
                const fileType = file.type.startsWith('image/') ? 'image' : 'file';

                const newItem = {
                    id: generateId(),
                    type: fileType,
                    title: title,
                    data: base64Data, // Base64 or DataURL
                    mimeType: file.type,
                    date: new Date().toLocaleString('tr-TR')
                };

                container.content.unshift(newItem);
                saveContainers();
                renderContainerContent(container);
                renderContainersList(); // Update item count

                // Clear inputs
                fileInput.value = '';
                titleInput.value = '';
                showMessageBox("Başarılı", ${fileType === 'image' ? 'Fotoğrafınız' : 'Dosyanız'} konuma eklendi.);
            };

            reader.onerror = function(error) {
                console.error("Dosya okuma hatası:", error);
                showMessageBox("Hata", "Dosya yüklenirken bir sorun oluştu.");
            };

            reader.readAsDataURL(file);
        }

        function deleteContentItem(containerId, itemId) {
            if (confirm("Bu öğeyi kalıcı olarak silmek istediğinizden emin misiniz?")) {
                const container = getContainerById(containerId);
                if (container) {
                    container.content = container.content.filter(item => item.id !== itemId);
                    saveContainers();
                    renderContainerContent(container);
                    renderContainersList(); // Update item count
                    showMessageBox("Başarılı", "Öğe başarıyla silindi.");
                }
            }
        }

        // --- Initialization ---
        window.onload = loadContainers;

    </script>
</body>
</html>
